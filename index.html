<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#004a99">
    <title>Balk & Hammarband Pro</title>
    <style>
        body { font-family: -apple-system, system-ui, sans-serif; padding: 15px; background: #f0f2f5; color: #333; margin: 0; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); max-width: 500px; margin: auto; }
        h1 { font-size: 1.3rem; margin-top: 0; color: #004a99; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .section-title { font-weight: bold; margin-top: 20px; color: #004a99; font-size: 0.8rem; text-transform: uppercase; border-left: 3px solid #e67e22; padding-left: 8px; }
        label { display: block; margin-top: 12px; font-weight: 600; font-size: 0.85rem; }
        select, input { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        .result-box { margin-top: 15px; padding: 15px; background: #004a99; color: white; border-radius: 10px; text-align: center; }
        .val { font-weight: bold; font-size: 1.5rem; display: block; }
        .weight-badge { display: inline-block; background: #eee; color: #555; padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; margin-top: 10px; font-weight: bold; }
        .hammar-res { background: #27ae60; margin-top: 10px; }
        .info-text { font-size: 0.7rem; color: #777; margin-top: 15px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="card">
    <h1>Balk & Hammarband Pro</h1>
    
    <label>Balktyp</label>
    <select id="type" onchange="updateSizes()">
        <option value="HEA">HEA (Bredfläns)</option>
        <option value="HEB (Normal)">HEB (Normal)</option>
        <option value="HEM (Tung)">HEM (Tung)</option>
        <option value="UPE (U-balk)">UPE (U-balk)</option>
    </select>

    <label>Storlek</label>
    <select id="size" onchange="calculate()"></select>
    <div id="unitWeightBox" style="text-align:center;"><span class="weight-badge" id="resUnitWeight">Vikt: - kg/m</span></div>

    <div class="result-box">
        <div style="font-size: 0.75rem; opacity: 0.9;">PLÅTMÅTT (H x B)</div>
        <span class="val" id="resMått">-</span>
    </div>

    <div class="section-title">Punktlast / Pelare</div>
    <label>Antal stöd</label>
    <input type="number" id="numSupports" placeholder="t.ex. 2" oninput="calculate()">
    <label>Last per stöd (kN)</label>
    <input type="number" id="load" placeholder="Valfritt" oninput="calculate()">

    <div id="loadResult" class="result-box" style="display:none; background: #e67e22;">
        <strong>Punktlast-resultat:</strong><br>
        Antal plåtar: <span id="resTotalQty">-</span> st<br>
        Rek. tjocklek: <span id="resT">-</span> mm
    </div>

    <div class="section-title">Hammarband (Spont)</div>
    <label>Balkens längd (mm)</label>
    <input type="number" id="beamLen" placeholder="t.ex. 6000" oninput="calculate()">
    <label>Önskat c/c mellan avstyvningar (mm)</label>
    <input type="number" id="ccDist" value="600" oninput="calculate()">
    <label>Sponttryck (kN/m) <small>(Valfritt för tjocklek)</small></label>
    <input type="number" id="spontLoad" placeholder="t.ex. 150" oninput="calculate()">

    <div id="hammarResult" class="result-box hammar-res" style="display:none;">
        <strong>Hammarband-resultat:</strong><br>
        Antal avstyvningar: <span id="resHamQty">-</span> st<br>
        Rek. tjocklek: <span id="resHamT">-</span> mm<br>
        <small>Totalvikt balk: <span id="resTotalWeight">-</span> kg</small>
    </div>

    <div class="info-text">
        * Höjd (H) = (h-2*tf)-4 | Bredd (B) = (b-tw)/2 - 10.<br>
        * Tjocklek baseras på flytgräns S355 och valt c/c-mått.
    </div>
</div>

<script>
const data = {
    "HEA": {
        100:[96,100,8,5,16.7], 120:[114,120,8,5,19.9], 140:[133,140,8.5,5.5,24.7], 160:[152,160,9,6,30.4], 
        180:[171,180,9.5,6,35.5], 200:[190,200,10,6.5,42.3], 220:[210,220,11,7,50.5], 240:[230,240,12,7.5,60.3], 
        260:[250,260,12.5,7.5,68.2], 280:[270,280,13,8,76.4], 300:[290,300,14,8.5,88.3], 320:[310,300,15.5,9,97.6], 
        340:[330,300,16.5,9.5,105], 360:[350,300,17.5,10,112], 400:[390,300,19,11,125], 450:[440,300,21,11.5,140], 
        500:[490,300,23,12,155], 600:[590,300,25,13,178], 700:[690,300,27,14.5,204], 800:[790,300,28,15,224]
    },
    "HEB (Normal)": {
        100:[100,100,10,6,20.4], 120:[120,120,11,6.5,26.7], 140:[140,140,12,7,33.7], 160:[160,160,13,8,42.6], 
        180:[180,180,14,8.5,51.2], 200:[200,200,15,9,61.3], 220:[220,220,16,9.5,71.5], 240:[240,240,17,10,83.2], 
        260:[260,260,17.5,10,93], 280:[280,280,18,10.5,103], 300:[300,300,19,11,117], 320:[320,300,20.5,11.5,127], 
        400:[400,300,24,13.5,155], 500:[500,300,28,14.5,187], 600:[600,300,30,15.5,212], 700:[700,300,32,17,241], 
        800:[800,300,33,17.5,262], 1000:[1000,300,36,19,314]
    },
    "HEM (Tung)": {
        100:[120,106,20,12,41.8], 120:[140,126,20,12.5,52.1], 140:[160,146,22,13,63.2], 160:[180,166,23,14,76.2], 
        200:[220,206,25,15,103], 240:[270,248,32,18,157], 300:[340,310,39,21,238], 400:[432,307,40,21,256], 500:[524,306,40,21,270]
    },
    "UPE (U-balk)": {
        80:[80,50,7,4,7.9], 100:[100,55,7.5,4.5,9.8], 120:[120,60,8,5,12.1], 140:[140,65,9,5,14.5], 
        160:[160,70,9.5,5.5,17], 180:[180,75,10.5,6,19.7], 200:[200,80,11,6,22.8], 220:[220,85,12,6.5,26.6], 
        240:[240,90,12.5,7,30.2], 270:[270,95,13.5,7.5,35.2], 300:[300,100,15,9.5,44.4], 400:[400,115,18,13.5,72.2]
    }
};

function updateSizes() {
    const type = document.getElementById('type').value;
    const sizeSelect = document.getElementById('size');
    sizeSelect.innerHTML = "";
    Object.keys(data[type]).sort((a,b)=>a-b).forEach(s => {
        let opt = document.createElement('option');
        opt.value = s; opt.innerHTML = s;
        sizeSelect.appendChild(opt);
    });
    calculate();
}

function calculate() {
    const type = document.getElementById('type').value;
    const size = document.getElementById('size').value;
    if(!data[type][size]) return;
    const [h, b, tf, tw, weight] = data[type][size];

    document.getElementById('resUnitWeight').innerText = "Vikt: " + weight + " kg/m";

    const hStiff = (h - 2 * tf) - 4;
    const bStiff = Math.floor((type.includes('UPE')) ? (b - tw) - 10 : ((b - tw) / 2) - 10);
    document.getElementById('resMått').innerText = hStiff.toFixed(1) + " x " + bStiff;

    // PUNKTLAST
    const numSupports = parseInt(document.getElementById('numSupports').value);
    const loadkN = parseFloat(document.getElementById('load').value);
    if (!isNaN(numSupports) && numSupports > 0) {
        document.getElementById('loadResult').style.display = 'block';
        const pPerS = (type.includes('UPE')) ? 1 : 2;
        document.getElementById('resTotalQty').innerText = pPerS * numSupports;
        let tVal = tw;
        if (!isNaN(loadkN)) {
            let tReq = (loadkN * 1000) / 355 / pPerS / bStiff;
            tVal = Math.max(tw, tReq);
        }
        document.getElementById('resT').innerText = Math.ceil(tVal);
    } else {
        document.getElementById('loadResult').style.display = 'none';
    }

    // HAMMARBAND
    const bLenMm = parseFloat(document.getElementById('beamLen').value);
    const ccDist = parseFloat(document.getElementById('ccDist').value) || 600;
    const sLoad = parseFloat(document.getElementById('spontLoad').value);
    
    if (!isNaN(bLenMm) && bLenMm > 0) {
        document.getElementById('hammarResult').style.display = 'block';
        const qtyBase = Math.ceil(bLenMm / ccDist) + 1;
        const totalQty = (type.includes('UPE') ? qtyBase : qtyBase * 2);
        document.getElementById('resHamQty').innerText = totalQty;
        
        let tValH = tw;
        if (!isNaN(sLoad)) {
            // Beräkna last per avstyvningspunkt baserat på valt c/c
            let loadPerPoint = (sLoad * (ccDist / 1000)); 
            let tReqH = (loadPerPoint * 1000) / 355 / (type.includes('UPE') ? 1 : 2) / bStiff;
            tValH = Math.max(tw, tReqH);
        }
        document.getElementById('resHamT').innerText = Math.ceil(tValH);
        document.getElementById('resTotalWeight').innerText = ((bLenMm / 1000) * weight).toFixed(1);
    } else {
        document.getElementById('hammarResult').style.display = 'none';
    }
}
updateSizes();
</script>
</body>
</html>
